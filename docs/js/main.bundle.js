!function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";i(s(1));function i(t){return t&&t.__esModule?t:{default:t}}new(i(s(2)).default)({autocompleteInputClass:"input",labelTitle:"Города",autocompleteLoaderClass:"loader",fontSizeInputForTooltip:20,controlButtons:!0,clearBtnSwitch:!0,message:!0,messageErrorText:"Ошибка!",messageWarningText:"Предупреждение!",messageSuccessText:"Успех!",timeRemoveMessage:11e3,tooltip:!0,showTooltipTime:2e3,showResultSide:!0,filterFirstLetter:!1,strictComparison:!1,minChars:1,loader:!0,timeRequest:1100,customData:{url:"/static/city2.json",type:"GET",key:"name"},callAjaxSuccess:function(t){}}).init()},function(t,e,s){},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),l=s(3),o=(i=l)&&i.__esModule?i:{default:i};var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.body=document.querySelector("body"),this.inputClass=e.autocompleteInputClass,this.input=document.querySelector("."+this.inputClass),this.containerClass=e.autocompleteContainerClass||"autocomplete",this.resultClass=e.autocompleteResultClass||"autocomplete__result",this.labelClass=e.autocompleteLabelClass||"autocomplete__label",this.wrapperClass=e.autocompleteWrapClass||"autocomplete__inputbox",this.clearBtnClass=e.autocompleteClearBtnClass||"autocomplete__clear",this.clearBtnSwitch=e.clearBtnSwitch||!1,this.labelTitle=e.labelTitle||!1,this.addWrapper(),this.inputFontSize=e.fontSizeInputForTooltip||18,this.container=document.querySelector("."+this.containerClass),this.result=document.querySelector("."+this.resultClass),this.clearBtn=document.querySelector("."+this.clearBtnClass),this.classMessage=e.autocompleteMessageClass||"autocomplete__msg",this.useMessage=e.message||!1,this.messageErrorText=e.messageErrorText||"Ошибка!",this.messageWarningText=e.messageWarningText||"Предупреждение!",this.messageSuccessText=e.messageSuccessText||"Успех!",this.timeRemoveMessage=e.timeRemoveMessage||1e3,this.strictComparison=e.strictComparison||!1,this.filterFirstLetter=e.filterFirstLetter||!1,this.tooltipUse=e.tooltip||!1,this.showTooltipTime=e.showTooltipTime||2500,this.loader=e.loader||!1,this.loaderClass=e.autocompleteLoaderClass||"loader",this.requestThrottle=e.requestThrottle||!1,this.requestDebounce=e.requestDebounce||!1,this.timeRequest=e.timeRequest||1e3,this.callError="function"==typeof e.callError?e.callError:"",this.callSuccess="function"==typeof e.callSuccess?e.callSuccess:"",this.callWarning="function"==typeof e.callWarning?e.callWarning:"",this.callAjaxError="function"==typeof e.callAjaxError?e.callAjaxError:"",this.callAjaxSuccess="function"==typeof e.callAjaxSuccess?e.callAjaxSuccess:"",this.callSortArray="function"==typeof e.callSortArray?e.callSortArray:"",this.arrayData=Array.isArray(e.arrayData)?e.arrayData:"",this.customData="object"===a(e.customData)?e.customData:"",this.showResultSide=e.showResultSide||!1,this.controlButtons=e.controlButtons||!1,this.minChars=e.minChars||0,this.curentIndex=0,this.moveScroll=0,this.ARROWUP=38,this.ENTERCODE=13,this.ARROWDOWN=40,this.resultHeight=0,this.itemHeightSum=0,this.arrResult=[]}return r(t,[{key:"addWrapper",value:function(){var t=document.createElement("div"),e=document.createElement("div"),s=document.createElement("ul"),i=this.input.parentElement;if(t.setAttribute("class",this.containerClass),e.setAttribute("class",this.wrapperClass),s.setAttribute("class",this.resultClass),this.labelTitle){var a=document.createElement("laber");a.setAttribute("class",this.labelClass),a.textContent=this.labelTitle,t.appendChild(a)}if(t.appendChild(e),t.appendChild(s),e.appendChild(this.input),this.clearBtnSwitch){var r=document.createElement("i");r.setAttribute("class",this.clearBtnClass),e.appendChild(r)}i.appendChild(t)}},{key:"addEventListners",value:function(){var t=this;this.input.addEventListener("keyup",o.default.debounce((function(e){t.checkKeys(e)||(t.arrResult=[],t.eventThrottle(e,this))}),this.timeRequest)),this.result.addEventListener("click",(function(e){"LI"==e.target.tagName&&t.chooseItem(e.target)})),t.clearBtnSwitch&&this.clearBtn.addEventListener("click",(function(){t.input.value="",t.removeMessage(),t.removeTooltip()})),this.body.addEventListener("click",(function(){t.result.style.visibility="hidden"})),this.body.addEventListener("keyup",(function(e){t.controlButtons&&t.shiftKeys(e)})),this.result.addEventListener("mouseover",(function(e){var s=e.target,i=t.container.getElementsByClassName("autocomplete__tooltip");"LI"==s.tagName&&(t.hover(e.target),i.length<=0&&t.shrinkToFill()&&t.tooltip(this.value))})),this.input.addEventListener("mouseover",(function(){t.container.getElementsByClassName("autocomplete__tooltip").length<=0&&t.shrinkToFill()&&t.tooltip(this.value)}))}},{key:"eventThrottle",value:function(t,e){var s=e.value.trim();this.success(s,t)}},{key:"success",value:function(t){this.result.style.visibility="visible",t&&t.length>=this.minChars?(this.curentIndex=0,this.removeMessage(),this.arrayData?this.sortArrayResult(this.arrayData,t):this.customData?this.onLoad(t):(this.callError&&this.callError(),this.choiceMessage("error")),this.overflowResult()):(this.curentIndex=0,this.removeMessage(),this.result.style.visibility="hidden")}},{key:"overflowResult",value:function(){var t=this.result.getElementsByTagName("li");this.resultHeight=this.getHeight(this.result),this.itemHeightSum=0;for(var e=0;e<t.length;e++)this.itemHeightSum+=this.getHeight(t[e]);this.resultHeight<this.itemHeightSum?this.result.style.overflowY="scroll":this.result.style.overflow="hidden"}},{key:"onLoad",value:function(t){var e=new XMLHttpRequest;if(this.loader&&this.container.classList.add(this.loaderClass),e.open(this.customData.type,this.customData.url,!1),"GET"==this.customData.type?e.send():e.send(t),200!=e.status)this.container.classList.remove(this.loaderClass),this.choiceMessage("error"),this.callAjaxError&&this.callAjaxError();else{this.container.classList.remove(this.loaderClass);var s=JSON.parse(e.responseText);this.sortResult(s,t),this.callAjaxSuccess&&this.callAjaxSuccess(s,t)}}},{key:"sortResult",value:function(t,e){this.result.innerHTML="",this.deepEqual(t),this.callSortArray&&this.callSortArray(t),this.sortArrayResult(this.arrResult,e)}},{key:"deepEqual",value:function(t,e){var s=this;if("result"==e)return s.arrResult.push(t),!0;Object.keys(t).forEach((function(e){s.equal(t[e],e)}))}},{key:"equal",value:function(t,e){switch(this.getType(t)){case"object":return this.deepEqual(t);case"array":return this.eqArray(t);default:e==this.customData.key&&this.deepEqual(t,"result")}}},{key:"getType",value:function(t){return"object"===(void 0===t?"undefined":a(t))?Array.isArray(t)?"array":"object":void 0===t?"undefined":a(t)}},{key:"eqArray",value:function(t){for(var e=0;e<t.length;e++)switch(this.getType(t[e])){case"object":return this.deepEqual(t);case"array":return this.eqArray(t)}}},{key:"sortArrayResult",value:function(t,e){var s,i=this,a="",r="",l="";i.result.innerHTML="",t.sort(),i.filterFirstLetter?(a="i",r="^",i.strictComparison&&(a="g")):(a="g",r="",l=!0,i.strictComparison&&(l=!1)),0==(s=t.filter((function(t){return l&&(t=t.toLowerCase(),e=e.toLowerCase()),t.match(i.generateRegex(e,a,r,l))}))).length&&(i.result.style.visibility="hidden",this.callWarning&&this.callWarning(),i.choiceMessage("warning")),i.addItem(s)}},{key:"generateRegex",value:function(t,e,s){var i=s,a=t.trim().split(" ");return a.forEach((function(t,e){i+=t+"\\w*"+(a.length-1>e?"\\s+":"")})),new RegExp(i,e)}},{key:"addItem",value:function(t){for(var e="",s=0;s<t.length;s++)e=(e||"")+'<li data-number="'+s+'" >'+t[s]+"</li>";this.result.innerHTML=e,this.resultHeight=this.getHeight(this.result);var i=this.positionResult("result");this.showResultSide?"top"==i?(this.result.style.display="block",this.result.style.position="absolute",this.result.style.bottom="40px",this.result.classList.remove(this.resultClass+"_bottom"),this.result.classList.add(this.resultClass+"_top")):(this.result.style.display="block",this.result.style.position="static",this.result.classList.remove(this.resultClass+"_top"),this.result.classList.add(this.resultClass+"_bottom")):this.result.style.display="block";for(var a=this.result.getElementsByTagName("li"),r=0;r<a.length;r++)a[0].classList.add("active_item")}},{key:"getHeight",value:function(t){var e,s=window.getComputedStyle(t),i=s.display,a=s.position,r=s.visibility,l=s.maxHeight.replace("px","").replace("%","");return"none"!==i&&"0"!==l?t.offsetHeight:(t.style.position="absolute",t.style.visibility="hidden",t.style.display="block",e=t.offsetHeight,t.style.display=i,t.style.position=a,t.style.visibility=r,e)}},{key:"positionResult",value:function(t){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),s=this.input.getBoundingClientRect().top;return"result"==t?s>e-this.resultHeight?"top":"bottom":"tooltip"==t?s>e/6?"top":"bottom":void 0}},{key:"hover",value:function(t){var e=t.getAttribute("data-number"),s=this.result.getElementsByTagName("li");this.curentIndex=+e;for(var i=0;i<s.length;i++)s[i].classList.remove("active_item");t.classList.add("active_item")}},{key:"checkKeys",value:function(t){return t.keyCode==this.ARROWDOWN||t.keyCode==this.ARROWUP||t.keyCode==this.ENTERCODE}},{key:"shiftKeys",value:function(t){var e=this.result.getElementsByTagName("li"),s=e[this.curentIndex];if(this.checkKeys(t)&&e.length){var i=s.getAttribute("data-number");switch(t.keyCode){case+this.ARROWDOWN:this.choiceMove("down",e,i,s);break;case+this.ARROWUP:this.choiceMove("up",e,i,s);break;case+this.ENTERCODE:this.chooseItem(s)}}}},{key:"choiceMove",value:function(t,e,s,i){var a=e.length-1,r=this.getHeight(i),l=+s;"down"==t&&(this.curentIndex>=a?(this.curentIndex=0,this.moveScroll=0):(this.moveScroll+=r,this.curentIndex=l+1)),"up"==t&&(this.curentIndex<=0?(this.curentIndex=e.length-1,this.moveScroll=a*r):(this.curentIndex=l-1,this.moveScroll-=r)),this.result.scrollTop=this.moveScroll,this.addClassForItems(e,this.curentIndex)}},{key:"addClassForItems",value:function(t,e){for(var s=0;s<t.length;s++)t[s].classList.remove("active_item");t[e].classList.add("active_item")}},{key:"chooseItem",value:function(t){this.choiceMessage("success"),this.input.value=t.innerHTML,this.result.innerHTML="",this.result.style.visibility="hidden",this.curentIndex=0,this.shrinkToFill()&&this.tooltip(this.input.value),this.callSuccess&&this.callSuccess()}},{key:"shrinkToFill",value:function(){if(this.input.value){this.input.style.fontSize;var t=this.input.value,e=this.input.clientWidth;return this.measureText(t,this.inputFontSize).width>e}}},{key:"measureText",value:function(t,e){var s=document.createElement("span");s.id="text-width-tester",s.style.fontSize=e,s.style.visibility="hidden",s.style.fontSize=e+"px",s.innerHTML=t,s.length?(s.style.fontSize=e+"px",s.innerHTML=t):this.body.appendChild(s);var i={width:s.offsetWidth,height:s.offsetHeight};return this.body.removeChild(s),i}},{key:"tooltip",value:function(t){var e=this;if(e.tooltipUse){var s=e.positionResult("tooltip"),i=document.createElement("div");"top"==s?(i.className="autocomplete__tooltip autocomplete__tooltip_top",i.innerHTML=t,e.container.appendChild(i)):(i.className="autocomplete__tooltip autocomplete__tooltip_bottom",i.innerHTML=t,e.container.appendChild(i)),setTimeout((function(){e.removeTooltip()}),this.showTooltipTime)}}},{key:"removeTooltip",value:function(){var t=this.container.getElementsByClassName("autocomplete__tooltip");t.length&&this.container.removeChild(t[0])}},{key:"checkMessage",value:function(t){var e=this.container.getElementsByClassName(this.classMessage);if(e.length){var s=this.classMessage+t;if(e[0].classList.contains(s))return!1}return!0}},{key:"choiceMessage",value:function(t){if(this.checkMessage(t)&&this.useMessage)switch(t){case"error":this.addMessage("error",this.messageErrorText);break;case"warning":this.addMessage("warning",this.messageWarningText);break;case"success":this.addMessage("success",this.messageSuccessText);break;default:console.log("")}}},{key:"addMessage",value:function(t,e){var s=document.createElement("div");s.className=this.classMessage+" "+this.classMessage+"_"+t,s.innerHTML=e,this.container.insertBefore(s,null),this.timerRemoveMessage(this.timeRemoveMessage)}},{key:"timerRemoveMessage",value:function(t){var e=this;setTimeout((function(){e.removeMessage()}),t)}},{key:"removeMessage",value:function(){var t=this.container.getElementsByClassName(this.classMessage);t.length&&this.container.removeChild(t[0])}},{key:"disable",value:function(){this.input.classList.add("disabled"),this.input.setAttribute("disabled","disabled")}},{key:"enable",value:function(){this.input.classList.remove("disabled"),this.input.removeAttribute("disabled")}},{key:"init",value:function(){this.addEventListners()}}]),t}();e.default=n},function(t,e,s){"use strict";t.exports={throttle:function(t,e,s){e||(e=250);var i=void 0,a=void 0;return function(){var r=s||this,l=+new Date,o=arguments;i&&l<i+e?(clearTimeout(a),a=setTimeout((function(){i=l,t.apply(r,o)}),e)):(i=l,t.apply(r,o))}},debounce:function(t,e,s){var i=void 0;return function(){var a=this,r=arguments,l=function(){i=null,s||t.apply(a,r)},o=s&&!i;clearTimeout(i),i=setTimeout(l,e),o&&t.apply(a,r)}}}}]);